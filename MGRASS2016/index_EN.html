<!DOCTYPE html>
<html>
	<head>
		<title>Fluvial dynamics of R. Paglia</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
		<link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.3/leaflet.css" />
		<link rel="stylesheet" href="css/MarkerCluster.css" />
		<link rel="stylesheet" href="css/MarkerCluster.Default.css" />
		<link rel="stylesheet" type="text/css" href="css/own_style.css">
		<link rel="stylesheet" href="css/label.css" />
		<link rel="stylesheet" href="css/styledLayerControl.css" />
		<link rel="stylesheet" href="css/L.Control.Locate.css" />
		<link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet">
		<link rel="stylesheet" href="css/leaflet-sidebar.css" />
		<link rel="stylesheet" href="http://leaflet.github.io/Leaflet.draw/leaflet.draw.css"/>
		<link rel="stylesheet" href="css/leaflet.measurecontrol.css" />
		<link rel="shortcut icon" href="pictures/favicon.ico" type="image/x-icon">
		
		<script src="http://code.jquery.com/jquery-1.11.1.min.js"></script>
		<script src="http://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.3/leaflet.js"></script>
		<script src="js/leaflet-hash.js"></script>
		<script src="js/label.js"></script>
		<script src="js/Autolinker.min.js"></script>
		<script src="js/leaflet.markercluster.js"></script>
		<script src="js/styledLayerControl.js"></script>
		<script src="js/L.Control.Locate.js"></script>
		<script src="js/leaflet-sidebar.js"></script>
		<script src="http://leaflet.github.io/Leaflet.draw/leaflet.draw.js"></script>
		<script src="js/leaflet.measurecontrol.js"></script>
		
		<style>
        body {
            padding: 0;
            margin: 0;
        }

        html, body, #map {
            height: 100%;
            font: 10pt "Helvetica Neue", Arial, Helvetica, sans-serif;
        }

        .lorem {
            font-style: italic;
            color: #AAA;
        }
        .custom .leaflet-popup-tip,
        .custom .leaflet-popup-content-wrapper {
             background: #2c3e50;
             color: #ffffff;        
        }
        .custom .leaflet-popup-content-wrapper a {
              color:rgba(255,255,255,0.5);
        }
        
        .imageborder { 
              border: 1px solid #000; 
              padding: 1px;
         }
        .imageborderWhite { 
              border: 1px solid #ffffff; 
              
         }         
        
        </style>		
		
	</head>
	<body>
		    <div id="sidebar" class="sidebar collapsed">
        <!-- Nav tabs -->
        <ul class="sidebar-tabs" role="tablist">
            <li><a href="#home" role="tab"><i class="fa fa-home fa-lg"></i></a></li>
            <li><a href="#settings" role="tab"><i class="fa fa-map-o"></i></a></li>
            <li><a href="#tour" role="tab"><i class="fa fa-picture-o"></i></a></li>
<!--          
            <li><a href="#messages" role="tab"><i class="fa fa-envelope"></i></a></li>-->
            
        </ul>

        <!-- Tab panes -->
        <div class="sidebar-content active">
            <div class="sidebar-pane" id="home">
                <h1 class="sidebar-header">Fluvial dynamics of Paglia River<span class="sidebar-close"><i class="fa fa-caret-left"></i></span></h1>                             
                               
                <p>The hydraulic risk is subject to wide attention by the media, technicians and researchers. Less known is the risk associated with sediment dynamics and erosion - sedimentation processes, ie <i>the riverbed dynamic risk</i>.</p>
                <p>To highlight the problems associated with the fluvial dynamics, it has been realized this map which shows the morphological, sedimentary and antrhopic features of the Paglia River (tributary of the Tiber River).
                Furthermore, a second <a href="variazioni_morfo_EN.html">map</a> was made showing the changes affecting the river over the last 200 years.</p>
		<p>The Paglia River is well suited for this purpose, because it shows intense erosion and riverbed incision, due to the mining of aggregates. This activity was carried out extensively in the past decades and gave rise to a strong sedimentary deficit in the river system.</p>
		<p>The web maps were made with FLOSS software.
                
                <ul> <li><a href="https://grass.osgeo.org/">GRASS</a> to georeference the historical documents: the Gregorian Cadastre maps (1820), the aerial photos of the GAI (1954) and AR08 (1977) flights.</li>
                <li>The GRASS plugin of <a href="http://www.qgis.org/">Qgis</a> for vectorizing the morphological elements.</li>
                <li>Qgis for data management and stylization.</li>
                <li><a href="http://leafletjs.com/">Leaflet</a> for the webmaps realization.</li></ul></p>
                
                <h2>Credits</h2>
                <p>The map was implemented by the Applied Geology group of the Physics and Geology Department - University of Perugia.</p>
                <p>For information or suggestions send a mail to andreafredd<i class="fa fa-at"></i>gmail.com</p>
                <p>The side panel icons are taken from <a href="http://fontawesome.io"> "Font Awesome by Dave Gandy - http://fontawesome.io"</a></p>
                <p>The map uses the following plugins:</p>
                <p><ul> <li><a href="https://github.com/gregjacobs/Autolinker.js">Autolinker.js</a></li>
                <li><a href="https://github.com/domoritz/leaflet-locatecontrol">leaflet-locatecontrol</a></li>
                <li><a href="https://github.com/makinacorpus/Leaflet.MeasureControl/">Leaflet.MeasureControl</a></li>
                <li><a href="https://github.com/Turbo87/leaflet-sidebar">leaflet-sidebar</a></li>
                <li><a href="https://github.com/davicustodio/Leaflet.StyledLayerControl">Leaflet.StyledLayerControl</a></li></ul></p>
                
                <HR>               
                <p style="text-align:center;">This work is distributed under license <a href="http://creativecommons.org/licenses/by-sa/4.0/" rel="license">Creative Commons Attribution-ShareAlike 4.0 International </a></p>
                <p style="text-align:center;"><a href="http://creativecommons.org/licenses/by-sa/4.0/" rel="license"><img class=" aligncenter" style="border-width:0;" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png" alt="Licenza Creative Commons" /></a></p>
<!--
                <p class="lorem">Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet.</p>
-->

            </div>                       
            <div class="sidebar-pane" id="settings">
				
		<h2 class="sidebar-header">Instructions<span class="sidebar-close"><i class="fa fa-caret-left"></i></span></h2>
		<p>Through the layers control panel, on the right, you can choose between 3 background maps, based on <a href="http://www.openstreetmap.org/">Openstreetmap</a>, including an aerial view.
		<BR>Vector layers, that can be interrogated (<i>popup</i>), are superimposed on the background maps.
		<BR>The layers show:
		<ul><li>the main morphological elements of the <b><u>floodplain</b></u> (slope boundaries, alluvial fans, river terraces, landslides) and of the <b><u>riverbed</u></b> (sedimentary bodies, channels);</li>
		<b><u><li>the hydraulic works</u></b> (transversal and longitudinal), to which are associated a photo and the link to a survey sheet;</li>
		<li><b><u>Historical informations</u></b> (the 1954 riverbed boundaries and ancient riverbed paths, whose age is not always known);</li>
		<li><b><u>Survey data</u></b> (interesting photographs for defining the morphological status of the river system and the points where a granulometric sampling of the riverbed's sediments was carried out).</li></ul></p>
				
		<h2>Legenda</h2>
		<img src="pictures/legenda_EN.svg" width="215px"/>
	    </div>
            <div class="sidebar-pane" id="tour">
				
		<h2 class="sidebar-header">Geomorphological tour on the River<span class="sidebar-close"><i class="fa fa-caret-left"></i></span></h2>
		<h3><u>The sediments source</u></h3>
		<p>Upstream the confluence with the Fossatello Creek, you can note the total absence of sedimentary bodies (Photo 1).</p>
		 <p align="center"><img src="pictures/rilev/DSC00662.JPG" width="85%" class="imageborder" /><br>
                 <a href="#" onclick="CentraFoto(42.776926452196953,11.934368196319662);">Photo 1 - Center the map on the photo</a>  </p>
                 <p>The situation changes completely downstream the confluence, where sedimentary bodies are very numerous and characterized by very coarse materials (Photo 2).</p>
                 <p align="center"><img src="pictures/rilev/DSC00659.JPG" width="85%" class="imageborder" /><br>
                 <a href="#" onclick="CentraFoto(42.77719240236829,11.9347352468109);">Photo 2 - Center the map on the photo</a>  </p>
                 <p>So, the <i>"source of the sediments"</i> of the lower valley of Paglia River was found, namely Fossatello Creek. The creek cuts chaotic and heterogeneous sediments (landslide accumulations) which also contain large blocks.
			These, transported downstream towards Paglia River, represent a very important source of sediments for the main stream (Photo 3).</p>
                 <p align="center"><img src="pictures/rilev/DSC00706.JPG" width="85%" class="imageborder" /><br>
                 <a href="#" onclick="CentraFoto(42.786458614961198,11.926206350379401);">Photo 3 - Center the map on the photo</a>  </p>
                 <p>Really, the whole initial reach (Torre Alfina Gorge) constitutes, together with Fossatello Creek, the source of the sediments of the Paglia River: the valley is very narrow and the slopes are characterized by frequent landslides (one of this is visible in the center of the photo n. 4). The landslides, set on the same chaotic deposits as in the photo n. 3, supply the riverbed with sediments, even very coarse.</p>
                 <p align="center"><img src="pictures/rilev/DSC00679.JPG" width="85%" class="imageborder" /><br>
                 <a href="#" onclick="CentraFoto(42.778359899838676,11.937361257876695);">Photo 4 - Center the map on the photo</a>  </p>
                 <h3><u>The process of riverbed entrenchment</u></h3>
                 <p>The Paglia River shows important problems of erosion and entrenchment of the riverbed, due above all to the intense mining activity of sediments, perpetrated in the past decades, which caused a strong sedimentary deficit in the fluvial system. </p>
                 <p>The process of entrenchment is evident by observing the riverbed and the river banks, but also the conditions of the works in the riverbed.</p>
                 <p>For example, observing the abutments of the old bridge of the provincial road SP 48 (Photo 6), destroyed during the flood of 1937, one realizes that the foundations of the work are elevated by about 5 m with respect to the current thalweg. This constitutes the first clear evidence of the rapidity of the process of entrenchment affecting the riverbed.</p> 
                 <p align="center"><img src="pictures/rilev/ponteSP48b.jpg" width="85%" class="imageborder" /><br>
                 <a href="#" onclick="CentraFoto(42.771908,12.034029);">Photo 6 - Center the map on the photo</a>  </p>
                 <p>Observing the bridges of the infrastructures on the alluvial plain, all the pylons inside the riverbed were grounded. For example, the central pillar of the bridge of the Rome - Florence railway has several underpinning orders (Photo 7 and Photo 8).</p>
                 <p align="center"><img src="pictures/rilev/IMG_20120906_132136.jpg" width="85%" class="imageborder" /><br> 
                 <a href="#" onclick="CentraFoto(42.773236,12.039012);"> Photo 7: the bridge of the Roma - Firenze (High Velocity) railway - Center the map on the photo</a></p>
                 <p align="center"><img src="pictures/rilev/IMG_20120906_141923.jpg" width="85%" class="imageborder" /><br> 
                 <a href="#" onclick="CentraFoto(42.776312,12.046882);"> Photo 8: The bridge of the Roma - Firenze (Normal railway line) - Center the map on the photo</a></p>
                 <p>Observing the riverbed, it is possible to notice how the river completely eroded its alluvial sediments and continued engraving (in some places over two meters) the bedrock, made up of Pliocene marine clays (Photo 15).</p>
                 <p align="center"><img src="pictures/rilev/IMG_20120907_152457.jpg" width="85%" class="imageborder" /><br> 
                 <a href="#" onclick="CentraFoto(42.748304,12.09829);"> Photo 15 - Center the map on the photo</a></p>
                 <p>Photo n. 12 shows how, for large reaches, the river flows on the Pliocene clay bedrock. This causes the flow to be much faster, because the clays have a much lower roughness coefficient than the alluvial sediments. Furthermore there are negative effects on the habitat and therefore on the reproduction of the fish fauna.</p>
                 <p align="center"><img src="pictures/rilev/IMG_20120907_114917.jpg" width="85%" class="imageborder" /><br> 
                 <a href="#" onclick="CentraFoto(42.758404,12.080747);"> Photo 12 - Center the map on the photo</a></p>
                 <p> Approaching the town of Orvieto Scalo, we see how the bedrock no longer outcrops on the banks, but only in the channel (Photo 18). This element shows that the entrenchment of the riverbed is lower. The cause is the construction of a weir, located downstream of Adunata Bridge. <u> All this increases the conditions of hydraulic risk in the area of Orvieto Scalo (the most anthropized)</u>: the upstream riverbed, due to the deepening, dispose downstream the water flows which, instead, in this area cause more and more frequent flooding.</p>
                 <p align="center"><img src="pictures/rilev/IMG_20120908_084659.jpg" width="85%" class="imageborder" /><br> 
                 <a href="#" onclick="CentraFoto(42.728116,12.126984);"> Photo 18 - Center the map on the photo</a></p>
                 <h3><u>Stream power, dynamics of the sediments and works in the riverbed</u></h3>
                 <p class="lorem">Under construction ...</p>
            </div>
        </div>
    </div>

    <div id="map" class="sidebar-map"></div>
		
		
		
<!--
Dati della mappa		
-->
		<script src="data/exp_progresivevalle.js"></script>
		<script src="data/exp_Assevalle.js"></script>
		<script src="data/exp_progressivealveo.js"></script>
		<script src="data/exp_Assealveo2008.js"></script>
		<script src="data/exp_alveo54linee.js"></script>
		<script src="data/inglese/exp_paleoalveilinee.js"></script>
		<script src="data/inglese/exp_Opianura.js"></script>
		<script src="data/exp_pennelli.js"></script>
		<script src="data/inglese/exp_Otrasversali.js"></script>
		<script src="data/inglese/exp_difesesponda.js"></script>
		<script src="data/inglese/exp_alveo2012join2.js"></script>
		<script src="data/exp_alveo2008join2.js"></script>
		<script src="data/exp_pianurajoin.js"></script>
		<script src="data/inglese/exp_pianurajoin2.js"></script>
		<script src="data/inglese/exp_granulTot.js"></script>
		<script src="data/inglese/exp_foto.js"></script>
		<script src="data/exp_Limitebacinoidrografico.js"></script>
		<script>
		var map = L.map('map', {
			zoomControl:false, maxZoom:18, minZoom:8
		}).setView([42.74500,12.07], 13);
		var hash = new L.Hash(map);
		var additional_attrib = 'created by A. Fredduzzi and P. De Rosa<br>';
		var feature_group = new L.featureGroup([]);
		var raster_group = new L.LayerGroup([]);
		var basemap_0 = L.tileLayer('http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', { 
			attribution: additional_attrib + '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
		});	
		
		basemap_0.addTo(map);
			
		var basemap_1 = L.tileLayer('http://a.tile.stamen.com/toner/{z}/{x}/{y}.png', { 
			attribution: additional_attrib + 'Map tiles by <a href="http://stamen.com">Stamen Design</a>, <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a> &mdash; Map data: &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors,<a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>'
		});
		var basemap_2 = L.tileLayer('http://{s}.tile.thunderforest.com/landscape/{z}/{x}/{y}.png', { 
			attribution: additional_attrib + '&copy; <a href="http://www.opencyclemap.org">OpenCycleMap</a>, &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors,<a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>'
		});
				
		var google_ibrida = L.tileLayer('http://mt0.google.com/vt/lyrs=s&hl=en&x={x}&y={y}&z={z}', { 
			attribution: additional_attrib + 'Map data &copy; 2021 <a href="https://about.google/brand-resource-center/products-and-services/geo-guidelines/#required-attribution">Google</a>'
		});
			
			
		var layerOrder=new Array();
		
		function doStyleLimitebacinoidrografico(feature) {
				return {
					weight: 2.3,
					color: '#00007f',
					dashArray: '',
					opacity: 1.0,
					fillOpacity: 1.0
				};
		}
		var exp_LimitebacinoidrograficoJSON = new L.geoJson(exp_Limitebacinoidrografico,{
			//onEachFeature: pop_Limitebacinoidrografico,
			style: doStyleLimitebacinoidrografico
		});
		//add comment sign to hide this layer on the map in the initial view.
		feature_group.addLayer(exp_LimitebacinoidrograficoJSON);
		
		function pop_pianurajoin(feature, layer) {					
			var popupContent = '<h3>Alluvial plain</h3><table><tr><th scope="row">Morphological unit</th><td>' + Autolinker.link(String(feature.properties['descrizio'])) + '</td></tr></table>';
			layer.bindPopup(popupContent,{'className':'custom'});
		}

		function doStylepianurajoin(feature) {
			switch (feature.properties.descrizio) {
				case 'conoide':
					return {
						weight: '1.3',
						fillColor: '#969f5c',
						color: '#000000',
						weight: '1',
						dashArray: '',
						opacity: '0.5',
						fillOpacity: '0.5',
					};
					break;
				case 'movimento franoso':
					return {
						weight: '1.3',
						fillColor: '#a24dcc',
						color: '#000000',
						weight: '1',
						dashArray: '',
						opacity: '0.5',
						fillOpacity: '0.5',
					};
					break;
				case 'pianura alluvionale':
					return {
						weight: '2.8',
						fillColor: '#ffffff',
						color: '#000000',
						weight: '2',
						dashArray: '',
						opacity: '0.1',
						fillOpacity: '0.1',
					};
					break;
				case 'terrazzo fluviale':
					return {
						weight: '1.3',
						fillColor: '#ca5a1d',
						color: '#000000',
						weight: '1',
						dashArray: '',
						opacity: '0.5',
						fillOpacity: '0.5',
					};
					break;
				case 'versante':
					return {
						weight: '1.3',
						fillColor: '#00aa7f',
						color: '#000000',
						weight: '1',
						dashArray: '1,5',
						opacity: '0.5',
						fillOpacity: '0.5',
					};
					break;
			}
		}
		var exp_pianurajoinJSON = new L.geoJson(exp_pianurajoin,{
			onEachFeature: pop_pianurajoin,
			style: doStylepianurajoin
		});
		//add comment sign to hide this layer on the map in the initial view.
		//feature_group.addLayer(exp_pianurajoinJSON);
		function pop_pianurajoin2(feature, layer) {					
			var popupContent = '<h3>Alluvial plain</h3><table><tr><th scope="row">Morphological unit:</th><td>' + Autolinker.link(String(feature.properties['d_en'])) + '</td></tr></table>';
			layer.bindPopup(popupContent,{'className':'custom'});
		}

		function doStylepianurajoin2(feature) {
			switch (feature.properties.descrizio) {
				case 'conoide':
					return {
						weight: '1.3',
						fillColor: '#969f5c',
						color: '#000000',
						weight: '1',
						dashArray: '',
						opacity: '0.5',
						fillOpacity: '0.5',
					};
					break;
				case 'movimento franoso':
					return {
						weight: '1.3',
						fillColor: '#a24dcc',
						color: '#000000',
						weight: '1',
						dashArray: '',
						opacity: '0.8',
						fillOpacity: '0.5',
					};
					break;
				case 'pianura alluvionale':
					return {
						weight: '1',
						fillColor: '#ffffff',
						color: '#000000',
						weight: '1.5',
						dashArray: '',
						opacity: '1',
						fillOpacity: '0.0',
					};
					break;
				case 'terrazzo fluviale':
					return {
						weight: '1.3',
						fillColor: '#ca5a1d',
						color: '#000000',
						weight: '1',
						dashArray: '',
						opacity: '0.8',
						fillOpacity: '0.5',
					};
					break;
				case 'versante':
					return {
						weight: '1.3',
						fillColor: '#00aa7f',
						color: '#000000',
						weight: '1',
						dashArray: '5,2',
						opacity: '0.5',
						fillOpacity: '0.5',
					};
					break;
			}
		}
		var exp_pianurajoin2JSON = new L.geoJson(exp_pianurajoin2,{
			onEachFeature: pop_pianurajoin2,
			style: doStylepianurajoin2
		});
		//add comment sign to hide this layer on the map in the initial view.
		feature_group.addLayer(exp_pianurajoin2JSON);
		function pop_alveo2008join2(feature, layer) {					
			var popupContent = '<h3>Alveo (2008)</h3><table><tr><th scope="row">Unità morfolgica:</th><td>' + Autolinker.link(String(feature.properties['descrizio'])) + '</td></tr></table>';
			layer.bindPopup(popupContent,{'className':'custom'});
		}

		function doStylealveo2008join2(feature) {
			switch (feature.properties.descrizio) {
				case 'barra attiva - nuda':
					return {
						weight: '1.3',
						fillColor: '#fdf56f',
						color: '#000000',
						weight: '1',
						dashArray: '',
						opacity: '0.5',
						fillOpacity: '0.5',
					};
					break;
				case 'barra attiva - vegetata':
					return {
						weight: '1.3',
						fillColor: '#49e43e',
						color: '#000000',
						weight: '1',
						dashArray: '',
						opacity: '0.5',
						fillOpacity: '0.5',
					};
					break;
				case 'barra sospesa - arborata':
					return {
						weight: '1.3',
						fillColor: '#24721f',
						color: '#000000',
						weight: '1',
						dashArray: '',
						opacity: '0.5',
						fillOpacity: '0.5',
					};
					break;
				case 'canale di magra':
					return {
						weight: '1.3',
						fillColor: '#289dea',
						color: '#000000',
						weight: '1',
						dashArray: '',
						opacity: '0.5',
						fillOpacity: '0.5',
					};
					break;
			}
		}
		var exp_alveo2008join2JSON = new L.geoJson(exp_alveo2008join2,{
			onEachFeature: pop_alveo2008join2,
			style: doStylealveo2008join2
		});
		//add comment sign to hide this layer on the map in the initial view.
		//feature_group.addLayer(exp_alveo2008join2JSON);
		function pop_alveo2012join2(feature, layer) {					
			var popupContent = '<h3>Riverbed (2012)</h3><table><tr><th scope="row">Morphological unit:</th><td>' + Autolinker.link(String(feature.properties['d_en'])) + '</td></tr></table>';
			layer.bindPopup(popupContent,{'className':'custom'});
		}

		function doStylealveo2012join2(feature) {
			switch (feature.properties.descrizio) {
				case 'barra attiva - nuda':
					return {
						weight: '1.3',
						fillColor: '#fdf56f',
						color: '#000000',
						weight: '1',
						dashArray: '',
						opacity: '0.5',
						fillOpacity: '0.5',
					};
					break;
				case 'barra attiva - vegetata':
					return {
						weight: '1.3',
						fillColor: '#49e43e',
						color: '#000000',
						weight: '1',
						dashArray: '',
						opacity: '0.5',
						fillOpacity: '0.5',
					};
					break;
				case 'barra sospesa - arborata':
					return {
						weight: '1.3',
						fillColor: '#24721f',
						color: '#000000',
						weight: '1',
						dashArray: '',
						opacity: '0.5',
						fillOpacity: '0.5',
					};
					break;
				case 'canale di magra':
					return {
						weight: '1.3',
						fillColor: '#289dea',
						color: '#000000',
						weight: '1',
						dashArray: '',
						opacity: '0.5',
						fillOpacity: '0.5',
					};
					break;
			}
		}
		var exp_alveo2012join2JSON = new L.geoJson(exp_alveo2012join2,{
			onEachFeature: pop_alveo2012join2,
			style: doStylealveo2012join2
		});
		//add comment sign to hide this layer on the map in the initial view.
		feature_group.addLayer(exp_alveo2012join2JSON);
		function pop_difesesponda(feature, layer) {					
			var popupContent = '<h3>Riverbed - bank protections </h3><table><tr><th scope="row">Id:</th><td>' + Autolinker.link(String(feature.properties['Id'])) + '</td></tr><tr><th scope="row">Type:</th><td>' + Autolinker.link(String(feature.properties['type'])) +'</td></tr><tr><th scope="row">Link:</th><td><a href="pictures/' + Autolinker.link(String(feature.properties['Scheda'])) +'">Survey sheet</a>'+ '</td></tr></table>'+'<img src="pictures/'+Autolinker.link(String(feature.properties['Link']))+'" width="300px" class="imageborderWhite"/>';
			layer.bindPopup(popupContent,{'className':'custom'});
		}

		function doStyledifesesponda(feature) {
			switch (feature.properties.Tipologia) {
				case 'muro':
					return {
						color: '#e31a1c',
						weight: '3.0',
						dashArray: '10,5',
						opacity: '0.7',
					};
					break;
				case 'scogliera':
					return {
						color: '#e31a1c',
						weight: '3.3',
						dashArray: '',
						opacity: '0.7',
					};
					break;
			}
		}
		var exp_difesespondaJSON = new L.geoJson(exp_difesesponda,{
			onEachFeature: pop_difesesponda,
			style: doStyledifesesponda
		});
		//add comment sign to hide this layer on the map in the initial view.
		//feature_group.addLayer(exp_difesespondaJSON);
		function pop_Otrasversali(feature, layer) {					
			var popupContent = '<h3>Riverbed - transverse works </h3><table><tr><th scope="row">Id:</th><td>' + Autolinker.link(String(feature.properties['Id'])) + '</td></tr><tr><th scope="row">Type:</th><td>' + Autolinker.link(String(feature.properties['type'])) +'</td></tr><tr><th scope="row">Link:</th><td><a href="pictures/' + Autolinker.link(String(feature.properties['Scheda'])) +'">Survey sheet</a>'+ '</td></tr></table>'+'<img src="pictures/'+Autolinker.link(String(feature.properties['Link']))+'" width="300px" class="imageborderWhite"/>';
			layer.bindPopup(popupContent,{'className':'custom'});
		}

		function doStyleOtrasversali(feature) {
			switch (feature.properties.Tipologia) {
				case 'briglia':
					return {
						color: '#ff0000',
						weight: '3.5',
						dashArray: '10,5',
						opacity: '0.7',
					};
					break;
				case 'guado':
					return {
						color: '#ff0000',
						weight: '3.5',
						dashArray: '1,5',
						opacity: '0.7',
					};
					break;
				case 'ponte':
					return {
						color: '#ff0000',
						weight: '3.5',
						dashArray: '',
						opacity: '0.7',
					};
					break;
			}
		}
		var exp_OtrasversaliJSON = new L.geoJson(exp_Otrasversali,{
			onEachFeature: pop_Otrasversali,
			style: doStyleOtrasversali
		});
		//exp_OtrasversaliJSON.bindLabel('feature.properties.Id', {noHide: false});
		//bindLabel(feature.properties.Id, {noHide: false})
		//add comment sign to hide this layer on the map in the initial view.
		//feature_group.addLayer(exp_OtrasversaliJSON);
		function pop_pennelli(feature, layer) {					
			var popupContent = '<table><tr><th scope="row">ID</th><td>' + Autolinker.link(String(feature.properties['ID'])) + '</td></tr></table>';
			layer.bindPopup(popupContent,{'className':'custom'});
		}

		var exp_pennelliJSON = new L.geoJson(exp_pennelli,{
			//onEachFeature: pop_pennelli,
			pointToLayer: function (feature, latlng) {  
				return L.circleMarker(latlng, {
					radius: 4.0,
					fillColor: '#ff0000',
					color: '#000000',
					weight: 1,
					opacity: 1.0,
					fillOpacity: 1.0
				})
			}
		});
		//add comment sign to hide this layer on the map in the initial view.
		//feature_group.addLayer(exp_pennelliJSON);
		function pop_Opianura(feature, layer) {					
			var popupContent = '<h3>Alluvial plain - levees</h3><table><tr><th scope="row">Type:</th><td>' + Autolinker.link(String(feature.properties['type'])) + '</td></tr><tr><th scope="row">Note:</th><td>' + Autolinker.link(String(feature.properties['Note'])) + '</td></tr></table>';
			layer.bindPopup(popupContent,{'className':'custom'});
		}

		function doStyleOpianura(feature) {
			switch (feature.properties.Tipologia) {
				case 'argine':
					return {
						color: '#ee3f00',
						weight: '3.5',
						dashArray: '',
						opacity: '0.7',
					};
					break;
				case 'rilevato autostrada':
					return {
						color: '#ee3f00',
						weight: '3.5',
						dashArray: '10,5',
						opacity: '0.7',
					};
					break;
				case 'rilevato ferrovia':
					return {
						color: '#ee3f00',
						weight: '3.5',
						dashArray: '15,5,1,5',
						opacity: '0.7',
					};
					break;
				case 'rilevato strada provinciale':
					return {
						color: '#ee3f00',
						weight: '3.5',
						dashArray: '10,5',
						opacity: '0.7',
					};
					break;
			}
		}
		var exp_OpianuraJSON = new L.geoJson(exp_Opianura,{
			onEachFeature: pop_Opianura,
			style: doStyleOpianura
		});    
		
		//.bindLabel(feature.properties.Km_text, {noHide: true})
		//add comment sign to hide this layer on the map in the initial view.
		//feature_group.addLayer(exp_OpianuraJSON);
		function pop_paleoalveilinee(feature, layer) {					
			var popupContent = '<h3>Ancient riverbed path</h3><table><tr><th scope="row">Date:</th><td>' + Autolinker.link(String(feature.properties['data'])) + '</td></tr></table>';
			layer.bindPopup(popupContent,{'className':'custom'});
		}

		function doStylepaleoalveilinee(feature) {
				return {
					weight: 3.5,
					color: '#00007f',
					dashArray: '10,5',
					opacity: 1.0,
					fillOpacity: 1.0
				};
		}
		var exp_paleoalveilineeJSON = new L.geoJson(exp_paleoalveilinee,{
			onEachFeature: pop_paleoalveilinee,
			style: doStylepaleoalveilinee
		});
		//add comment sign to hide this layer on the map in the initial view.
		//feature_group.addLayer(exp_paleoalveilineeJSON);
		//function pop_alveo54linee(feature, layer) {					
		//	var popupContent = '<h3>Limite storico alveo (1954)</h3><table><tr><th scope="row">Data</th><td>' + Autolinker.link(String(feature.properties['data'])) + '</td></tr></table>';
		//	layer.bindPopup(popupContent);
		//}

		function doStylealveo54linee(feature) {
				return {
					weight: 2.8,
					color: '#ff007f',
					dashArray: '15,5,1,5',
					opacity: 1.0,
					fillOpacity: 1.0
				};
		}
		var exp_alveo54lineeJSON = new L.geoJson(exp_alveo54linee,{
			//onEachFeature: pop_alveo54linee,
			style: doStylealveo54linee
		});
		//add comment sign to hide this layer on the map in the initial view.
		//feature_group.addLayer(exp_alveo54lineeJSON);
		
		function pop_granulTot(feature, layer) {					
		var popupContent = '<h3>Granulometric samples</h3><table><tr><th scope="row">Id:</th><td>' + Autolinker.link(String(feature.properties['Id'])) + '</td></tr><tr><th scope="row">Sampling year:</th><td>' + Autolinker.link(String(feature.properties['Anno'])) + '</td></tr><tr><th scope="row">Riverbed unit:</th><td>' + Autolinker.link(String(feature.properties['unit'])) + '</td></tr><tr><th scope="row">N. of clasts:</th><td>' + Autolinker.link(String(feature.properties['Clasti'])) + '</td></tr><tr><th scope="row">D50 (mm):</th><td>' + Autolinker.link(String(feature.properties['D50'])) + '</td></tr></table>';
			layer.bindPopup(popupContent,{'className':'custom'});
		}

		var exp_granulTotJSON = new L.geoJson(exp_granulTot,{
			onEachFeature: pop_granulTot,
			pointToLayer: function (feature, latlng) {  
				return L.marker(latlng, {icon: L.icon({
				iconUrl: 'icons/blue-marker.svg',
				iconSize:     [40, 40], // size of the icon change this to scale your icon (first coordinate is x, second y from the upper left corner of the icon)
				iconAnchor:   [27, 20], // point of the icon which will correspond to marker's location (first coordinate is x, second y from the upper left corner of the icon)
				popupAnchor:  [-7, -13] // point from which the popup should open relative to the iconAnchor (first coordinate is x, second y from the upper left corner of the icon)
			 	})
			 	}).bindLabel(feature.properties.Id, {noHide: false})
			}
		});
		var cluster_groupgranulTotJSON= new L.MarkerClusterGroup({showCoverageOnHover: true});
		cluster_groupgranulTotJSON.addLayer(exp_granulTotJSON);
		//add comment sign to hide this layer on the map in the initial view.
		//exp_granulTotJSON.addTo(map);
		
		function pop_foto(feature, layer) {					
			var popupContent = '<h3>Photographic documentation</h3><table><tr><th scope="row">Id:</th><td>' + Autolinker.link(String(feature.properties['Id'])) + '</td></tr><tr><th scope="row">Azimuth:</th><td>' + Autolinker.link(String(feature.properties['Azimut'])) +'° from north'+'</td></tr><tr><th scope="row">Date:</th><td>' + Autolinker.link(String(feature.properties['Data'])) + '</td></tr><tr><th scope="row">Link:</th><td><a href="pictures/rilev/' + Autolinker.link(String(feature.properties['Link'])) +'">Open photo</a>'+'</td></tr></table>'+'<img src="pictures/rilev/'+Autolinker.link(String(feature.properties['Link']))+'" width="300px" class="imageborderWhite"/>'+'<b>Description:</b> '+ Autolinker.link(String(feature.properties['Descrizio']));
			layer.bindPopup(popupContent, {'className':'custom'});
		}

		var exp_fotoJSON = new L.geoJson(exp_foto,{
			onEachFeature: pop_foto,
			pointToLayer: function (feature, latlng) {
				return L.marker(latlng, {
					icon: L.icon({
						iconUrl: feature.properties.icon_exp,
						iconSize:     [24, 24], // size of the icon change this to scale your icon (first coordinate is x, second y from the upper left corner of the icon)
						iconAnchor:   [12, 12], // point of the icon which will correspond to marker's location (first coordinate is x, second y from the upper left corner of the icon)
						popupAnchor:  [0, -14] // point from which the popup should open relative to the iconAnchor (first coordinate is x, second y from the upper left corner of the icon)
					})
				}).bindLabel(feature.properties.Id, {noHide: true})
			}}
		);
		var cluster_groupfotoJSON= new L.MarkerClusterGroup({showCoverageOnHover: false});
		cluster_groupfotoJSON.addLayer(exp_fotoJSON);
		//add comment sign to hide this layer on the map in the initial view.
		//exp_fotoJSON.addTo(map);
		
		function pop_Assealveo2008(feature, layer) {					
			var popupContent = '<table><tr><th scope="row">ASSE_AL_ID</th><td>' + Autolinker.link(String(feature.properties['ASSE_AL_ID'])) + '</td></tr><tr><th scope="row">note</th><td>' + Autolinker.link(String(feature.properties['note'])) + '</td></tr></table>';
			layer.bindPopup(popupContent,{'className':'custom'});
		}

		function doStyleAssealveo2008(feature) {
				return {
					weight: 2.8,
					color: '#000000',
					dashArray: '10,5',
					opacity: 1.0,
					fillOpacity: 1.0
				};
		}
		var exp_Assealveo2008JSON = new L.geoJson(exp_Assealveo2008,{
			//onEachFeature: pop_Assealveo2008,
			style: doStyleAssealveo2008
		});
		layerOrder[layerOrder.length] = exp_Assealveo2008JSON;
		for (index = 0; index < layerOrder.length; index++) {
			feature_group.removeLayer(layerOrder[index]);feature_group.addLayer(layerOrder[index]);
		}
		//add comment sign to hide this layer on the map in the initial view.
		feature_group.addLayer(exp_Assealveo2008JSON);
		function pop_progressivealveo(feature, layer) {					
			var popupContent = '<table><tr><th scope="row">Km</th><td>' + Autolinker.link(String(feature.properties['Km'])) + '</td></tr></table>';
			layer.bindPopup(popupContent,{'className':'custom'});
		}

		var exp_progressivealveoJSON = new L.geoJson(exp_progressivealveo,{
			onEachFeature: pop_progressivealveo,
			pointToLayer: function (feature, latlng) {  
				return L.circleMarker(latlng, {
					radius: 3.0,
					fillColor: '#000000',
					color: '#000000',
					weight: 1,
					opacity: 1.0,
					fillOpacity: 1.0
				}).bindLabel(feature.properties.Km_text, {noHide: true})
			}
		});
		//add comment sign to hide this layer on the map in the initial view.
		feature_group.addLayer(exp_progressivealveoJSON);
		//function pop_Assevalle(feature, layer) {					
		//	var popupContent = '<table><tr><th scope="row">ID</th><td>' + Autolinker.link(String(feature.properties['ID'])) + '</td></tr></table>';
		//	layer.bindPopup(popupContent);
		//}

		function doStyleAssevalle(feature) {
			switch (feature.properties.ID) {
				case '1':
					return {
						color: '#000000',
						weight: '2.3',
						dashArray: '',
						opacity: '1.0',
					};
					break;
				case '2':
					return {
						color: '#000000',
						weight: '1.0',
						dashArray: '10,5',
						opacity: '1.0',
					};
					break;
			}
		}
		var exp_AssevalleJSON = new L.geoJson(exp_Assevalle,{
			//onEachFeature: pop_Assevalle,
			style: doStyleAssevalle
		});
		//add comment sign to hide this layer on the map in the initial view.		
		//exp_AssevalleJSON.bindLabel('Even polylines can have labels.', { noHide: true });
		feature_group.addLayer(exp_AssevalleJSON);
		
		function pop_progresivevalle(feature, layer) {					
			var popupContent = '<table><tr><th scope="row">km</th><td>' + Autolinker.link(String(feature.properties['km'])) + '</td></tr></table>';
			layer.bindPopup(popupContent,{'className':'custom'});
		}

		var exp_progresivevalleJSON = new L.geoJson(exp_progresivevalle,{
			onEachFeature: pop_progresivevalle,
			pointToLayer: function (feature, latlng) {  
				return L.circleMarker(latlng, {
					radius: 3.0,
					fillColor: '#000000',
					color: '#000000',
					weight: 1,
					opacity: 1.0,
					fillOpacity: 1.0
				}).bindLabel(feature.properties.Km_text, {noHide: true})
			}
		});
		//add comment sign to hide this layer on the map in the initial view.
		feature_group.addLayer(exp_progresivevalleJSON);

    map.on('zoomend', function (e) {
    zoom_based_layerchange();
});

function clean_map() {
    map.eachLayer(function (layer) {
        if (layer instanceof L.GeoJSON)


        {
            map.removeLayer(layer);

        }
        //console.log(layer);


    });
}

//clean_map();

function zoom_based_layerchange() {
    //console.log(map.getZoom());

var currentZoom = map.getZoom();
    switch (currentZoom) {        
        case 10:
            clean_map();
            exp_LimitebacinoidrograficoJSON.addTo(map);       
            exp_Assealveo2008JSON.addTo(map); 
            break;
        case 11:
            clean_map();
            exp_LimitebacinoidrograficoJSON.addTo(map);        
            exp_Assealveo2008JSON.addTo(map); 
            break;
        case 12:
            clean_map();
            exp_LimitebacinoidrograficoJSON.addTo(map);
            exp_pianurajoin2JSON.addTo(map);                      
            exp_Assealveo2008JSON.addTo(map); 
            exp_AssevalleJSON.addTo(map);            
            break; 
        case 13:
            clean_map();
            exp_LimitebacinoidrograficoJSON.addTo(map);                       
            exp_pianurajoin2JSON.addTo(map);
            exp_Assealveo2008JSON.addTo(map); 
            exp_AssevalleJSON.addTo(map);
            exp_progressivealveoJSON.addTo(map);
            exp_progresivevalleJSON.addTo(map);            
            break;                
        case 14:
            clean_map();
            exp_LimitebacinoidrograficoJSON.addTo(map);                       
            exp_pianurajoin2JSON.addTo(map);
            exp_alveo2012join2JSON.addTo(map);
            exp_OpianuraJSON.addTo(map);
            exp_paleoalveilineeJSON.addTo(map);
            exp_alveo54lineeJSON.addTo(map);
            exp_Assealveo2008JSON.addTo(map); 
            exp_AssevalleJSON.addTo(map);
            exp_progressivealveoJSON.addTo(map);
            exp_progresivevalleJSON.addTo(map);            
            break;
        case 15:
            clean_map();
            exp_LimitebacinoidrograficoJSON.addTo(map);                       
            exp_pianurajoin2JSON.addTo(map);
            exp_alveo2012join2JSON.addTo(map);
            exp_difesespondaJSON.addTo(map);
            exp_OtrasversaliJSON.addTo(map);
            exp_pennelliJSON.addTo(map);
            exp_OpianuraJSON.addTo(map);
            exp_paleoalveilineeJSON.addTo(map);
            exp_alveo54lineeJSON.addTo(map);            
            exp_Assealveo2008JSON.addTo(map); 
            exp_AssevalleJSON.addTo(map);
            exp_progressivealveoJSON.addTo(map);
            exp_progresivevalleJSON.addTo(map);            
            break;
        case 16:
            clean_map();
            exp_LimitebacinoidrograficoJSON.addTo(map);                       
            exp_pianurajoin2JSON.addTo(map);
            exp_alveo2012join2JSON.addTo(map);
            exp_difesespondaJSON.addTo(map);
            exp_OtrasversaliJSON.addTo(map);
            exp_pennelliJSON.addTo(map);
            exp_OpianuraJSON.addTo(map);
            exp_paleoalveilineeJSON.addTo(map);
            exp_alveo54lineeJSON.addTo(map);
            exp_granulTotJSON.addTo(map);
            exp_fotoJSON.addTo(map);
            exp_Assealveo2008JSON.addTo(map); 
            exp_AssevalleJSON.addTo(map);
            exp_progressivealveoJSON.addTo(map);
            exp_progresivevalleJSON.addTo(map);            
            break;
        case 17:
            clean_map();
            exp_LimitebacinoidrograficoJSON.addTo(map);                       
            exp_pianurajoin2JSON.addTo(map);
            exp_alveo2012join2JSON.addTo(map);
            exp_difesespondaJSON.addTo(map);
            exp_OtrasversaliJSON.addTo(map);
            exp_pennelliJSON.addTo(map);
            exp_OpianuraJSON.addTo(map);
            exp_paleoalveilineeJSON.addTo(map);
            exp_alveo54lineeJSON.addTo(map);
            exp_granulTotJSON.addTo(map);
            exp_fotoJSON.addTo(map);
            exp_Assealveo2008JSON.addTo(map); 
            exp_AssevalleJSON.addTo(map);
            exp_progressivealveoJSON.addTo(map);
            exp_progresivevalleJSON.addTo(map);            
            break;                                           
         case 18:
            clean_map();
            exp_LimitebacinoidrograficoJSON.addTo(map);                       
            exp_pianurajoin2JSON.addTo(map);
            exp_alveo2012join2JSON.addTo(map);
            exp_difesespondaJSON.addTo(map);
            exp_OtrasversaliJSON.addTo(map);
            exp_pennelliJSON.addTo(map);
            exp_OpianuraJSON.addTo(map);
            exp_paleoalveilineeJSON.addTo(map);
            exp_alveo54lineeJSON.addTo(map);
            exp_granulTotJSON.addTo(map);
            exp_fotoJSON.addTo(map);
            exp_Assealveo2008JSON.addTo(map); 
            exp_AssevalleJSON.addTo(map);
            exp_progressivealveoJSON.addTo(map);
            exp_progresivevalleJSON.addTo(map);            
            break;           
        default:
            // do nothing
            break;
    }
}




		feature_group.addTo(map);
		var title = new L.Control();
		title.onAdd = function (map) {
			this._div = L.DomUtil.create('div', 'info'); // create a div with a class "info"
			this.update();
			return this._div;
		};
		title.update = function () {
			this._div.innerHTML = '<h1>Caratteri morfologico-sedimentari e antropici del F. Paglia</h1>'
		};
		//title.addTo(map);

	
	var baseMaps = [
                    { 
                        groupName : "TMS Background",
                        expanded : false,
                        layers    : { 
				
                            "OpenStreetMap"		:  basemap_0,
                            "Aerial view (Google)"	:  google_ibrida
                        }
                    }                       
    ];  
	
	var overlays = [
                     {
                        groupName : "Morphology",
                        expanded  : false,
                        layers    : { 
                            "<img src='icons/watershed.svg'width='25px'/> watershed boundary" : exp_LimitebacinoidrograficoJSON,
                            "<b><i>Alluvial plain </i></b> <br> <img src='icons/slopes.svg'width='25px'/> slopes <br> <img src='icons/lanslide.svg'width='25px'/> landslide <br> <img src='icons/fan.svg'width='25px'/> alluvial fan <br> <img src='icons/terrace.svg'width='25px'/> fluvial terrace" : exp_pianurajoin2JSON,
                            "<b><i>Riverbed (2012)</i></b> <br> <img src='icons/channel.svg'width='25px'/> low water channel <br> <img src='icons/n_bar.svg'width='25px'/> active - unvegetated bar <br> <img src='icons/v_bar.svg'width='25px'/> active - vegetated bar <br> <img src='icons/w_bar.svg'width='25px'/> inactive - wooded bar"     : exp_alveo2012join2JSON
                            //"Alveo (2008)"     : exp_alveo2008join2JSON                            
                        }    
                        }, {
                        groupName : "Hydraulic works",
                        expanded  : false,
                        layers    : { 
                            "<b><i>Riverbed - bank protections</i></b> <br> <img src='icons/wall.svg'width='25px'/> wall <br> <img src='icons/riprap.svg'width='25px'/> rip rap "		: exp_difesespondaJSON,
                            "<img src='icons/penn.svg'width='25px'/> groynes"			: exp_pennelliJSON,
                            "<b><i>Riverbed - transverse works</i></b> <br> <img src='icons/wall.svg'width='25px'/> weir <br> <img src='icons/soglia.svg'width='25px'/> not protruding weir <br> <img src='icons/riprap.svg'width='25px'/> bridge <br>"		: exp_OtrasversaliJSON,
                            
                            "<b><i>Alluvial plain - levees</i></b><br> <img src='icons/levee.svg'width='25px'/> levee</b> <br> <img src='icons/road.svg'width='25px'/> road embankment <br><img src='icons/rail.svg'width='25px'/> railway embankment"	: exp_OpianuraJSON
                        }
                        }, {
                        groupName : "Hystorical data",
                        expanded  : false,
                        layers    : { 
                            "<img src='icons/ariver.svg'width='25px'/> Ancient riverbed paths"		: exp_paleoalveilineeJSON,
                            "<img src='icons/1954.svg'width='25px'/> Riverbed boundaries (1954)"	: exp_alveo54lineeJSON
                        }
                        }, {
                        groupName : "Survey data",
                        expanded  : false,
                        layers    : { 
                            "<img src='icons/blue-marker.svg'width='25px'/>  Grain size samples": exp_granulTotJSON,
                            "<img src='icons/photo2.svg'width='25px'/>  Photos": exp_fotoJSON                           
                        }
                        }, {
                        groupName : "Fluvial reference systems",
                        expanded  : false,
                        layers    : { 
                            "<img src='icons/raxis.svg'width='25px'/> River axis (2008)"	: exp_Assealveo2008JSON,
                            "<img src='icons/rprog.svg'width='25px'/>River axis milestone (km)"	: exp_progressivealveoJSON,
                            "<img src='icons/vaxis.svg'width='25px'/>Valley axis"		: exp_AssevalleJSON,
                            "<img src='icons/vprog.svg'width='25px'/>Valley axis milestone (km)": exp_progresivevalleJSON
                        }                                                    							   
                     }                          
    ];
	var options = {
        position		: "topright",
        container_width     	: "235px",
        container_maxHeight 	: "370px", 
        group_maxHeight     	: "130px",
        collapsed		: true,
        exclusive           : false
    };
	
	var control = L.Control.styledLayerControl(baseMaps, overlays, options);
    map.addControl(control);
	
	    new L.Control.Zoom({ position: 'topright' }).addTo(map);
		L.control.locate({position: 'topright'}).addTo(map);
		L.control.scale({options: {position: 'bottomright',maxWidth: 100,metric: true,imperial: false,updateWhenIdle: false}}).addTo(map);
		var sidebar = L.control.sidebar('sidebar').addTo(map);
		L.Control.measureControl({position: 'topright'}).addTo(map);
		
        function CentraFoto(lat,lon) {
            map.setView(new L.LatLng(lat,lon), 18);
            clean_map();
            map.removeLayer(mapbox_streets);
            mapbox_satellite.addTo(map);                       
            exp_granulTotJSON.addTo(map);
            exp_fotoJSON.addTo(map);
		}
        
	</script>
</body>
</html>
